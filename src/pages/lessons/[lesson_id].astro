---
import Layout from '../../layouts/Layout.astro';
import LessonClientComponent from '../../components/lesson/LessonClientComponent';
import { lessons } from '../../data/lingo-lessons-data';
import type { Lesson } from '../../types/lesson';

export const prerender = true;

export interface Props {
  lesson_id: string;
  lesson: Lesson;
}

export async function getStaticPaths() {
  return lessons.map((lesson) => ({
    params: { lesson_id: lesson.lesson_id },
    props: { lesson }
  }));
}

const { lesson } = Astro.props;
---

<Layout title={`${lesson.title} - Speed of Mastery`}>
  <div class="container mx-auto max-w-3xl py-8 px-4">
    <div class="mb-6">
      <a href="/" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
        <svg class="mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        All Lessons
      </a>
    </div>
    
    <!-- Test content to see if page loads -->
    <div class="mb-6 p-4 bg-blue-100 border border-blue-300 rounded">
      <h1 class="text-2xl font-bold text-blue-800">Lesson: {lesson.title}</h1>
      <p class="text-blue-700">Level: {lesson.level}</p>
      <p class="text-blue-700">Topic: {lesson.topic}</p>
    </div>
    
    <!-- React component -->
    <LessonClientComponent lesson={lesson} client:only="react" />
    
    <!-- Fallback content if React fails -->
    <div class="mt-8 p-4 bg-yellow-100 border border-yellow-300 rounded">
      <h2 class="text-lg font-semibold text-yellow-800">Lesson Content (Fallback)</h2>
      <p class="text-yellow-700 mt-2">{lesson.arabic_explanation}</p>
    </div>
  </div>
</Layout>
